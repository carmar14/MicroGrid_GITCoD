/*
 * File: mpc_genC.c
 *
 * Code generated for Simulink model 'mpc_genC'.
 *
 * Model version                  : 1.5
 * Simulink Coder version         : 8.12 (R2017a) 16-Feb-2017
 * C/C++ source code generated on : Sat Apr 21 19:01:00 2018
 *
 * Target selection: ert.tlc
 * Embedded hardware selection: Intel->x86-64 (Windows64)
 * Code generation objectives: Unspecified
 * Validation result: Not run
 */

#include "mpc_genC.h"
#include "mpc_genC_private.h"

/* Named constants for MATLAB Function: '<S2>/optimizer' */
#define mpc_genC_ny                    (4.0)

/* Block states (auto storage) */
DW_mpc_genC_T mpc_genC_DW;

/* External inputs (root inport signals with auto storage) */
ExtU_mpc_genC_T mpc_genC_U;

/* External outputs (root outports fed by signals with auto storage) */
ExtY_mpc_genC_T mpc_genC_Y;

/* Real-time model */
RT_MODEL_mpc_genC_T mpc_genC_M_;
RT_MODEL_mpc_genC_T *const mpc_genC_M = &mpc_genC_M_;
static void rate_scheduler(void);

/*
 *   This function updates active task flag for each subrate.
 * The function is called at model base rate, hence the
 * generated code self-manages all its subrates.
 */
static void rate_scheduler(void)
{
  /* Compute which subrates run during the next base time step.  Subrates
   * are an integer multiple of the base rate counter.  Therefore, the subtask
   * counter is reset when it reaches its limit (zero means run).
   */
  (mpc_genC_M->Timing.TaskCounters.TID[1])++;
  if ((mpc_genC_M->Timing.TaskCounters.TID[1]) > 29999) {/* Sample time: [0.03s, 0.0s] */
    mpc_genC_M->Timing.TaskCounters.TID[1] = 0;
  }
}

/* Model step function */
void mpc_genC_step(void)
{
  real_T xk[8];
  real_T y_innov[4];
  real_T rseq[40];
  int32_T i;
  real_T zopt[32];
  real_T f[32];
  int32_T b_j;
  static const real_T b_Hinv[1024] = { 1.5227177997539014, 0.0, 0.0, 0.0,
    -1.8279111314849514, 0.0, 0.0, 0.0, 0.29309074175403504, 0.0, 0.0, 0.0,
    0.012864757416132687, 0.0, 0.0, 0.0, -0.00070374333870418249, 0.0, 0.0, 0.0,
    -5.9687250993342537E-5, 0.0, 0.0, 0.0, 1.0358296150126797E-6, 0.0, 0.0, 0.0,
    2.2732779793611327E-7, 0.0, 0.0, 0.0, 0.0, 1.9542794649752708, 0.0, 0.0, 0.0,
    -2.4786122623102735, 0.0, 0.0, 0.0, 0.49558194627518937, 0.0, 0.0, 0.0,
    0.030891424297678678, 0.0, 0.0, 0.0, -0.0019009277452964374, 0.0, 0.0, 0.0,
    -0.00024436253626952572, 0.0, 0.0, 0.0, 3.1472569881418879E-6, 0.0, 0.0, 0.0,
    1.5655661093867589E-6, 0.0, 0.0, 0.0, 0.0, 1.6401663885150117, 0.0, 0.0, 0.0,
    -2.0173622248523042, 0.0, 0.0, 0.0, 0.36060165863975513, 0.0, 0.0, 0.0,
    0.017748898212936046, 0.0, 0.0, 0.0, -0.0010553783024138943, 0.0, 0.0, 0.0,
    -0.00010162701462647249, 0.0, 0.0, 0.0, 1.8088214586298908E-6, 0.0, 0.0, 0.0,
    4.758682523896342E-7, 0.0, 0.0, 0.0, 0.0, 1.5999850512960931, 0.0, 0.0, 0.0,
    -1.9188281142309203, 0.0, 0.0, 0.0, 0.30552618925225583, 0.0, 0.0, 0.0,
    0.014137533239303448, 0.0, 0.0, 0.0, -0.00075354379559203894, 0.0, 0.0, 0.0,
    -6.8444763717632426E-5, 0.0, 0.0, 0.0, 1.0574502014559713E-6, 0.0, 0.0, 0.0,
    2.71351320841927E-7, -1.8279111314849514, 0.0, 0.0, 0.0, 3.716991160941753,
    0.0, 0.0, 0.0, -2.1797450888170906, 0.0, 0.0, 0.0, 0.27764754323076113, 0.0,
    0.0, 0.0, 0.013709549782779768, 0.0, 0.0, 0.0, -0.0006320943671130492, 0.0,
    0.0, 0.0, -6.0956343122858452E-5, 0.0, 0.0, 0.0, 9.4447921135461108E-7, 0.0,
    0.0, 0.0, 0.0, -2.4786122623102735, 0.0, 0.0, 0.0, 5.0979029113543648, 0.0,
    0.0, 0.0, -3.1071587476179259, 0.0, 0.0, 0.0, 0.45640235900773868, 0.0, 0.0,
    0.0, 0.0333023713789985, 0.0, 0.0, 0.0, -0.0015910176005195717, 0.0, 0.0,
    0.0, -0.00024857197483965459, 0.0, 0.0, 0.0, 2.4610581920055862E-6, 0.0, 0.0,
    0.0, 0.0, -2.0173622248523042, 0.0, 0.0, 0.0, 4.1214697335650321, 0.0, 0.0,
    0.0, -2.4608929357931615, 0.0, 0.0, 0.0, 0.33877097304023523, 0.0, 0.0, 0.0,
    0.019046986390539884, 0.0, 0.0, 0.0, -0.000930382869835467, 0.0, 0.0, 0.0,
    -0.0001039116724963162, 0.0, 0.0, 0.0, 1.6108559531316129E-6, 0.0, 0.0, 0.0,
    0.0, -1.9188281142309203, 0.0, 0.0, 0.0, 3.901194883838198, 0.0, 0.0, 0.0,
    -2.2852391885695962, 0.0, 0.0, 0.0, 0.28857134569783577, 0.0, 0.0, 0.0,
    0.015041242392867912, 0.0, 0.0, 0.0, -0.000671460938662414, 0.0, 0.0, 0.0,
    -6.974326433340804E-5, 0.0, 0.0, 0.0, 9.4834895494846589E-7,
    0.29309074175403504, 0.0, 0.0, 0.0, -2.1797450888170906, 0.0, 0.0, 0.0,
    3.7734048857404949, 0.0, 0.0, 0.0, -2.1772688970192831, 0.0, 0.0, 0.0,
    0.27751208786173026, 0.0, 0.0, 0.0, 0.013698056526467356, 0.0, 0.0, 0.0,
    -0.0006319953510844741, 0.0, 0.0, 0.0, -6.0190508924999424E-5, 0.0, 0.0, 0.0,
    0.0, 0.49558194627518937, 0.0, 0.0, 0.0, -3.1071587476179259, 0.0, 0.0, 0.0,
    5.2235765777227909, 0.0, 0.0, 0.0, -3.0993250509812964, 0.0, 0.0, 0.0,
    0.45592030743523132, 0.0, 0.0, 0.0, 0.033240383965895091, 0.0, 0.0, 0.0,
    -0.0015905035547212644, 0.0, 0.0, 0.0, -0.00024636622500725353, 0.0, 0.0,
    0.0, 0.0, 0.36060165863975513, 0.0, 0.0, 0.0, -2.4608929357931615, 0.0, 0.0,
    0.0, 4.2007504438167613, 0.0, 0.0, 0.0, -2.4569907205845256, 0.0, 0.0, 0.0,
    0.33853894151990582, 0.0, 0.0, 0.0, 0.019024632967441987, 0.0, 0.0, 0.0,
    -0.00093017265048327667, 0.0, 0.0, 0.0, -0.00010256504904431327, 0.0, 0.0,
    0.0, 0.0, 0.30552618925225583, 0.0, 0.0, 0.0, -2.2852391885695962, 0.0, 0.0,
    0.0, 3.95953683662266, 0.0, 0.0, 0.0, -2.2825395466638279, 0.0, 0.0, 0.0,
    0.28842745248568535, 0.0, 0.0, 0.0, 0.015028167562197272, 0.0, 0.0, 0.0,
    -0.00067135766336234273, 0.0, 0.0, 0.0, -6.897347203600942E-5,
    0.012864757416132687, 0.0, 0.0, 0.0, 0.27764754323076113, 0.0, 0.0, 0.0,
    -2.1772688970192831, 0.0, 0.0, 0.0, 3.7735135728405855, 0.0, 0.0, 0.0,
    -2.1772748585848478, 0.0, 0.0, 0.0, 0.27751190249688829, 0.0, 0.0, 0.0,
    0.01370489208611987, 0.0, 0.0, 0.0, -0.00068023683012867259, 0.0, 0.0, 0.0,
    0.0, 0.030891424297678678, 0.0, 0.0, 0.0, 0.45640235900773868, 0.0, 0.0, 0.0,
    -3.0993250509812964, 0.0, 0.0, 0.0, 5.2240648625519635, 0.0, 0.0, 0.0,
    -3.0993552251306626, 0.0, 0.0, 0.0, 0.45591878991984308, 0.0, 0.0, 0.0,
    0.033274955475558317, 0.0, 0.0, 0.0, -0.0017959715263678236, 0.0, 0.0, 0.0,
    0.0, 0.017748898212936046, 0.0, 0.0, 0.0, 0.33877097304023523, 0.0, 0.0, 0.0,
    -2.4569907205845256, 0.0, 0.0, 0.0, 4.2009425079386959, 0.0, 0.0, 0.0,
    -2.457002178016396, 0.0, 0.0, 0.0, 0.3385385275332024, 0.0, 0.0, 0.0,
    0.019037627469919154, 0.0, 0.0, 0.0, -0.00101399156746839, 0.0, 0.0, 0.0,
    0.0, 0.014137533239303448, 0.0, 0.0, 0.0, 0.28857134569783577, 0.0, 0.0, 0.0,
    -2.2825395466638279, 0.0, 0.0, 0.0, 3.9596617546378683, 0.0, 0.0, 0.0,
    -2.2825462235601277, 0.0, 0.0, 0.0, 0.28842722955058048, 0.0, 0.0, 0.0,
    0.015035924727510494, 0.0, 0.0, 0.0, -0.00072655040209784988,
    -0.00070374333870418249, 0.0, 0.0, 0.0, 0.013709549782779768, 0.0, 0.0, 0.0,
    0.27751208786173026, 0.0, 0.0, 0.0, -2.1772748585848478, 0.0, 0.0, 0.0,
    3.7735137227146711, 0.0, 0.0, 0.0, -2.1772713069995562, 0.0, 0.0, 0.0,
    0.2775870649415989, 0.0, 0.0, 0.0, 0.013169949611747727, 0.0, 0.0, 0.0, 0.0,
    -0.0019009277452964374, 0.0, 0.0, 0.0, 0.0333023713789985, 0.0, 0.0, 0.0,
    0.45592030743523132, 0.0, 0.0, 0.0, -3.0993552251306626, 0.0, 0.0, 0.0,
    5.2240658341671082, 0.0, 0.0, 0.0, -3.0993384747075816, 0.0, 0.0, 0.0,
    0.45616013094662566, 0.0, 0.0, 0.0, 0.031818344461849446, 0.0, 0.0, 0.0, 0.0,
    -0.0010553783024138943, 0.0, 0.0, 0.0, 0.019046986390539884, 0.0, 0.0, 0.0,
    0.33853894151990582, 0.0, 0.0, 0.0, -2.457002178016396, 0.0, 0.0, 0.0,
    4.2009428354169591, 0.0, 0.0, 0.0, -2.4569955075459475, 0.0, 0.0, 0.0,
    0.3386629135083335, 0.0, 0.0, 0.0, 0.018226665814858468, 0.0, 0.0, 0.0, 0.0,
    -0.00075354379559203894, 0.0, 0.0, 0.0, 0.015041242392867912, 0.0, 0.0, 0.0,
    0.28842745248568535, 0.0, 0.0, 0.0, -2.2825462235601277, 0.0, 0.0, 0.0,
    3.9596619197483034, 0.0, 0.0, 0.0, -2.282542262554009, 0.0, 0.0, 0.0,
    0.28850663752675132, 0.0, 0.0, 0.0, 0.014465969225442424,
    -5.9687250993342537E-5, 0.0, 0.0, 0.0, -0.0006320943671130492, 0.0, 0.0, 0.0,
    0.013698056526467356, 0.0, 0.0, 0.0, 0.27751190249688829, 0.0, 0.0, 0.0,
    -2.1772713069995562, 0.0, 0.0, 0.0, 3.7734434119231164, 0.0, 0.0, 0.0,
    -2.178778337251591, 0.0, 0.0, 0.0, 0.28821159557811593, 0.0, 0.0, 0.0, 0.0,
    -0.00024436253626952572, 0.0, 0.0, 0.0, -0.0015910176005195717, 0.0, 0.0,
    0.0, 0.033240383965895091, 0.0, 0.0, 0.0, 0.45591878991984308, 0.0, 0.0, 0.0,
    -3.0993384747075816, 0.0, 0.0, 0.0, 5.2237597307537467, 0.0, 0.0, 0.0,
    -3.1038546201617829, 0.0, 0.0, 0.0, 0.48293099751241286, 0.0, 0.0, 0.0, 0.0,
    -0.00010162701462647249, 0.0, 0.0, 0.0, -0.000930382869835467, 0.0, 0.0, 0.0,
    0.019024632967441987, 0.0, 0.0, 0.0, 0.3385385275332024, 0.0, 0.0, 0.0,
    -2.4569955075459475, 0.0, 0.0, 0.0, 4.2008199045244954, 0.0, 0.0, 0.0,
    -2.4593251297198546, 0.0, 0.0, 0.0, 0.35366814545214514, 0.0, 0.0, 0.0, 0.0,
    -6.8444763717632426E-5, 0.0, 0.0, 0.0, -0.000671460938662414, 0.0, 0.0, 0.0,
    0.015028167562197272, 0.0, 0.0, 0.0, 0.28842722955058048, 0.0, 0.0, 0.0,
    -2.282542262554009, 0.0, 0.0, 0.0, 3.9595812126133025, 0.0, 0.0, 0.0,
    -2.284181964773305, 0.0, 0.0, 0.0, 0.30015938917031459,
    1.0358296150126797E-6, 0.0, 0.0, 0.0, -6.0956343122858452E-5, 0.0, 0.0, 0.0,
    -0.0006319953510844741, 0.0, 0.0, 0.0, 0.01370489208611987, 0.0, 0.0, 0.0,
    0.2775870649415989, 0.0, 0.0, 0.0, -2.178778337251591, 0.0, 0.0, 0.0,
    3.7412511813636957, 0.0, 0.0, 0.0, -1.9503388401445088, 0.0, 0.0, 0.0, 0.0,
    3.1472569881418879E-6, 0.0, 0.0, 0.0, -0.00024857197483965459, 0.0, 0.0, 0.0,
    -0.0015905035547212644, 0.0, 0.0, 0.0, 0.033274955475558317, 0.0, 0.0, 0.0,
    0.45616013094662566, 0.0, 0.0, 0.0, -3.1038546201617829, 0.0, 0.0, 0.0,
    5.1575197869030971, 0.0, 0.0, 0.0, -2.7067851012015876, 0.0, 0.0, 0.0, 0.0,
    1.8088214586298908E-6, 0.0, 0.0, 0.0, -0.0001039116724963162, 0.0, 0.0, 0.0,
    -0.00093017265048327667, 0.0, 0.0, 0.0, 0.019037627469919154, 0.0, 0.0, 0.0,
    0.3386629135083335, 0.0, 0.0, 0.0, -2.4593251297198546, 0.0, 0.0, 0.0,
    4.1568595423039509, 0.0, 0.0, 0.0, -2.1738430077990492, 0.0, 0.0, 0.0, 0.0,
    1.0574502014559713E-6, 0.0, 0.0, 0.0, -6.974326433340804E-5, 0.0, 0.0, 0.0,
    -0.00067135766336234273, 0.0, 0.0, 0.0, 0.015035924727510494, 0.0, 0.0, 0.0,
    0.28850663752675132, 0.0, 0.0, 0.0, -2.284181964773305, 0.0, 0.0, 0.0,
    3.9263834515850835, 0.0, 0.0, 0.0, -2.046681140623595, 2.2732779793611327E-7,
    0.0, 0.0, 0.0, 9.4447921135461108E-7, 0.0, 0.0, 0.0, -6.0190508924999424E-5,
    0.0, 0.0, 0.0, -0.00068023683012867259, 0.0, 0.0, 0.0, 0.013169949611747727,
    0.0, 0.0, 0.0, 0.28821159557811593, 0.0, 0.0, 0.0, -1.9503388401445088, 0.0,
    0.0, 0.0, 2.1406803217343513, 0.0, 0.0, 0.0, 0.0, 1.5655661093867589E-6, 0.0,
    0.0, 0.0, 2.4610581920055862E-6, 0.0, 0.0, 0.0, -0.00024636622500725353, 0.0,
    0.0, 0.0, -0.0017959715263678236, 0.0, 0.0, 0.0, 0.031818344461849446, 0.0,
    0.0, 0.0, 0.48293099751241286, 0.0, 0.0, 0.0, -2.7067851012015876, 0.0, 0.0,
    0.0, 2.82841876409879, 0.0, 0.0, 0.0, 0.0, 4.758682523896342E-7, 0.0, 0.0,
    0.0, 1.6108559531316129E-6, 0.0, 0.0, 0.0, -0.00010256504904431327, 0.0, 0.0,
    0.0, -0.00101399156746839, 0.0, 0.0, 0.0, 0.018226665814858468, 0.0, 0.0,
    0.0, 0.35366814545214514, 0.0, 0.0, 0.0, -2.1738430077990492, 0.0, 0.0, 0.0,
    2.3323648015405114, 0.0, 0.0, 0.0, 0.0, 2.71351320841927E-7, 0.0, 0.0, 0.0,
    9.4834895494846589E-7, 0.0, 0.0, 0.0, -6.897347203600942E-5, 0.0, 0.0, 0.0,
    -0.00072655040209784988, 0.0, 0.0, 0.0, 0.014465969225442424, 0.0, 0.0, 0.0,
    0.30015938917031459, 0.0, 0.0, 0.0, -2.046681140623595, 0.0, 0.0, 0.0,
    2.2490877173540755 };

  static const real_T a[32] = { 0.060042788017464641, 0.0, 0.0, 0.0,
    0.023101937960645733, 0.0, 0.0, 0.0, 0.0, 0.066241326271145221, 0.0, 0.0,
    0.0, 0.024112346704921125, 0.0, 0.0, 0.0, 0.0, 0.063060115988297569, 0.0,
    0.0, 0.0, 0.02340771647661119, 0.0, 0.0, 0.0, 0.0, 0.05970030940253708, 0.0,
    0.0, 0.0, 0.023328050852245361 };

  static const real_T b_a[32] = { 6.3937499999999989, 0.0, 0.0, 0.0, 0.0,
    4.9799999999999995, 0.0, 0.0, 0.0, 0.0, 5.8323863636363642, 0.0, 0.0, 0.0,
    0.0, 6.23125, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0,
    0.0, 0.0, 0.0, 1.0 };

  static const real_T b_Kx[256] = { 1.5359195306779414, 0.0, 0.0, 0.0,
    9.9361771840060911, 0.0, 0.0, 0.0, 0.0, 1.6429835475275263, 0.0, 0.0, 0.0,
    9.5307139279904334, 0.0, 0.0, 0.0, 0.0, 1.6381658034219846, 0.0, 0.0, 0.0,
    9.9122981950879385, 0.0, 0.0, 0.0, 0.0, 1.4588394939554, 0.0, 0.0, 0.0,
    9.6836448215582376, 0.34270952440591462, 0.0, 0.0, 0.0, 8.9131774969441651,
    0.0, 0.0, 0.0, 0.0, 0.49484795570867773, 0.0, 0.0, 0.0, 8.5347200476259371,
    0.0, 0.0, 0.0, 0.0, 0.41892493328941782, 0.0, 0.0, 0.0, 8.8857994229836237,
    0.0, 0.0, 0.0, 0.0, 0.32551066587280325, 0.0, 0.0, 0.0, 8.6866451265428513,
    0.076468384616203769, 0.0, 0.0, 0.0, 7.8901788994353117, 0.0, 0.0, 0.0, 0.0,
    0.14903616109330109, 0.0, 0.0, 0.0, 7.5387403655313339, 0.0, 0.0, 0.0, 0.0,
    0.1071294898450746, 0.0, 0.0, 0.0, 7.8593042245310318, 0.0, 0.0, 0.0, 0.0,
    0.0726308229623528, 0.0, 0.0, 0.0, 7.6896464933890609, 0.017061956458956116,
    0.0, 0.0, 0.0, 6.8671851849645495, 0.0, 0.0, 0.0, 0.0, 0.044879650578619583,
    0.0, 0.0, 0.0, 6.542807823352879, 0.0, 0.0, 0.0, 0.0, 0.027394303053252276,
    0.0, 0.0, 0.0, 6.8328230004399266, 0.0, 0.0, 0.0, 0.0, 0.016205703117458305,
    0.0, 0.0, 0.0, 6.6926526191687774, 0.0038065906399338085, 0.0, 0.0, 0.0,
    5.8442133547522355, 0.0, 0.0, 0.0, 0.0, 0.013508313921020624, 0.0, 0.0, 0.0,
    5.5470317912077611, 0.0, 0.0, 0.0, 0.0, 0.0070036908169600481, 0.0, 0.0, 0.0,
    5.8063964215112733, 0.0, 0.0, 0.0, 0.0, 0.0036155570991439003, 0.0, 0.0, 0.0,
    5.6956800730087789, 0.00084891878471194944, 0.0, 0.0, 0.0,
    4.8213396029818165, 0.0, 0.0, 0.0, 0.0, 0.004059453688724516, 0.0, 0.0, 0.0,
    4.5517753906729048, 0.0, 0.0, 0.0, 0.0, 0.0017892170609010612, 0.0, 0.0, 0.0,
    4.7801835263192327, 0.0, 0.0, 0.0, 0.0, 0.00080631584243985642, 0.0, 0.0,
    0.0, 4.6988031125834535, 0.0001889731818177844, 0.0, 0.0, 0.0,
    3.7989054082924785, 0.0, 0.0, 0.0, 0.0, 0.0012135275773697981, 0.0, 0.0, 0.0,
    3.5582442278408646, 0.0, 0.0, 0.0, 0.0, 0.00045572555867824405, 0.0, 0.0,
    0.0, 3.7548062172476229, 0.0, 0.0, 0.0, 0.0, 0.00017948957313702166, 0.0,
    0.0, 0.0, 3.7023545377004909, 4.1720273468171719E-5, 0.0, 0.0, 0.0,
    2.7784411717692086, 0.0, 0.0, 0.0, 0.0, 0.00035640389422945029, 0.0, 0.0,
    0.0, 2.5704410559016884, 0.0, 0.0, 0.0, 0.0, 0.00011471872668054305, 0.0,
    0.0, 0.0, 2.7326963733360858, 0.0, 0.0, 0.0, 0.0, 3.9626543850981593E-5, 0.0,
    0.0, 0.0, 2.7078258536206272 };

  static const real_T b_Kr[1280] = { -0.794737846168156, -0.0, -0.0, -0.0,
    -0.97206782905967482, -0.0, -0.0, -0.0, -1.0116354965413776, -0.0, -0.0,
    -0.0, -1.02046423652327, -0.0, -0.0, -0.0, -1.0224341946893383, -0.0, -0.0,
    -0.0, -1.0228737517704187, -0.0, -0.0, -0.0, -1.0229718302123145, -0.0, -0.0,
    -0.0, -1.0229937144707619, -0.0, -0.0, -0.0, -1.022998597508854, -0.0, -0.0,
    -0.0, -1.0229996870619256, -0.0, -0.0, -0.0, -0.0, -0.69601056493544666,
    -0.0, -0.0, -0.0, -0.90564491852374507, -0.0, -0.0, -0.0,
    -0.96878557244249652, -0.0, -0.0, -0.0, -0.987803171939176, -0.0, -0.0, -0.0,
    -0.99353116283204024, -0.0, -0.0, -0.0, -0.99525640053485676, -0.0, -0.0,
    -0.0, -0.99577603214511778, -0.0, -0.0, -0.0, -0.99593254217845506, -0.0,
    -0.0, -0.0, -0.99597968209460241, -0.0, -0.0, -0.0, -0.995993880364496, -0.0,
    -0.0, -0.0, -0.0, -0.76399401734920225, -0.0, -0.0, -0.0,
    -0.95936956558454856, -0.0, -0.0, -0.0, -1.009332790402335, -0.0, -0.0, -0.0,
    -1.022109843911537, -0.0, -0.0, -0.0, -1.02537730907161, -0.0, -0.0, -0.0,
    -1.0262128951920408, -0.0, -0.0, -0.0, -1.0264265789286537, -0.0, -0.0, -0.0,
    -1.0264812240911048, -0.0, -0.0, -0.0, -1.0264951984525916, -0.0, -0.0, -0.0,
    -1.0264987721043151, -0.0, -0.0, -0.0, -0.0, -0.77453923033201533, -0.0,
    -0.0, -0.0, -0.94736229283723949, -0.0, -0.0, -0.0, -0.98592433045137229,
    -0.0, -0.0, -0.0, -0.9945286840798635, -0.0, -0.0, -0.0,
    -0.99644857488296246, -0.0, -0.0, -0.0, -0.99687696042532548, -0.0, -0.0,
    -0.0, -0.9969725461599982, -0.0, -0.0, -0.0, -0.99699387422028363, -0.0,
    -0.0, -0.0, -0.99699863315379078, -0.0, -0.0, -0.0, -0.99699969501538632,
    -0.0, -0.0, -0.0, -0.0, -0.794737846168156, -0.0, -0.0, -0.0,
    -0.97206782905967482, -0.0, -0.0, -0.0, -1.0116354965413776, -0.0, -0.0,
    -0.0, -1.02046423652327, -0.0, -0.0, -0.0, -1.0224341946893383, -0.0, -0.0,
    -0.0, -1.0228737517704187, -0.0, -0.0, -0.0, -1.0229718302123145, -0.0, -0.0,
    -0.0, -1.0229937144707619, -0.0, -0.0, -0.0, -1.022998597508854, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.69601056493544666, -0.0, -0.0, -0.0,
    -0.90564491852374507, -0.0, -0.0, -0.0, -0.96878557244249652, -0.0, -0.0,
    -0.0, -0.987803171939176, -0.0, -0.0, -0.0, -0.99353116283204024, -0.0, -0.0,
    -0.0, -0.99525640053485676, -0.0, -0.0, -0.0, -0.99577603214511778, -0.0,
    -0.0, -0.0, -0.99593254217845506, -0.0, -0.0, -0.0, -0.99597968209460241,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.76399401734920225, -0.0,
    -0.0, -0.0, -0.95936956558454856, -0.0, -0.0, -0.0, -1.009332790402335, -0.0,
    -0.0, -0.0, -1.022109843911537, -0.0, -0.0, -0.0, -1.02537730907161, -0.0,
    -0.0, -0.0, -1.0262128951920408, -0.0, -0.0, -0.0, -1.0264265789286537, -0.0,
    -0.0, -0.0, -1.0264812240911048, -0.0, -0.0, -0.0, -1.0264951984525916, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.77453923033201533, -0.0, -0.0,
    -0.0, -0.94736229283723949, -0.0, -0.0, -0.0, -0.98592433045137229, -0.0,
    -0.0, -0.0, -0.9945286840798635, -0.0, -0.0, -0.0, -0.99644857488296246,
    -0.0, -0.0, -0.0, -0.99687696042532548, -0.0, -0.0, -0.0,
    -0.9969725461599982, -0.0, -0.0, -0.0, -0.99699387422028363, -0.0, -0.0,
    -0.0, -0.99699863315379078, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.794737846168156, -0.0, -0.0, -0.0, -0.97206782905967482, -0.0, -0.0, -0.0,
    -1.0116354965413776, -0.0, -0.0, -0.0, -1.02046423652327, -0.0, -0.0, -0.0,
    -1.0224341946893383, -0.0, -0.0, -0.0, -1.0228737517704187, -0.0, -0.0, -0.0,
    -1.0229718302123145, -0.0, -0.0, -0.0, -1.0229937144707619, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.69601056493544666,
    -0.0, -0.0, -0.0, -0.90564491852374507, -0.0, -0.0, -0.0,
    -0.96878557244249652, -0.0, -0.0, -0.0, -0.987803171939176, -0.0, -0.0, -0.0,
    -0.99353116283204024, -0.0, -0.0, -0.0, -0.99525640053485676, -0.0, -0.0,
    -0.0, -0.99577603214511778, -0.0, -0.0, -0.0, -0.99593254217845506, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.76399401734920225, -0.0, -0.0, -0.0, -0.95936956558454856, -0.0, -0.0,
    -0.0, -1.009332790402335, -0.0, -0.0, -0.0, -1.022109843911537, -0.0, -0.0,
    -0.0, -1.02537730907161, -0.0, -0.0, -0.0, -1.0262128951920408, -0.0, -0.0,
    -0.0, -1.0264265789286537, -0.0, -0.0, -0.0, -1.0264812240911048, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.77453923033201533, -0.0, -0.0, -0.0, -0.94736229283723949, -0.0, -0.0,
    -0.0, -0.98592433045137229, -0.0, -0.0, -0.0, -0.9945286840798635, -0.0,
    -0.0, -0.0, -0.99644857488296246, -0.0, -0.0, -0.0, -0.99687696042532548,
    -0.0, -0.0, -0.0, -0.9969725461599982, -0.0, -0.0, -0.0,
    -0.99699387422028363, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.794737846168156, -0.0, -0.0, -0.0, -0.97206782905967482,
    -0.0, -0.0, -0.0, -1.0116354965413776, -0.0, -0.0, -0.0, -1.02046423652327,
    -0.0, -0.0, -0.0, -1.0224341946893383, -0.0, -0.0, -0.0, -1.0228737517704187,
    -0.0, -0.0, -0.0, -1.0229718302123145, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.69601056493544666, -0.0, -0.0, -0.0, -0.90564491852374507, -0.0, -0.0,
    -0.0, -0.96878557244249652, -0.0, -0.0, -0.0, -0.987803171939176, -0.0, -0.0,
    -0.0, -0.99353116283204024, -0.0, -0.0, -0.0, -0.99525640053485676, -0.0,
    -0.0, -0.0, -0.99577603214511778, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.76399401734920225,
    -0.0, -0.0, -0.0, -0.95936956558454856, -0.0, -0.0, -0.0, -1.009332790402335,
    -0.0, -0.0, -0.0, -1.022109843911537, -0.0, -0.0, -0.0, -1.02537730907161,
    -0.0, -0.0, -0.0, -1.0262128951920408, -0.0, -0.0, -0.0, -1.0264265789286537,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.77453923033201533, -0.0, -0.0, -0.0,
    -0.94736229283723949, -0.0, -0.0, -0.0, -0.98592433045137229, -0.0, -0.0,
    -0.0, -0.9945286840798635, -0.0, -0.0, -0.0, -0.99644857488296246, -0.0,
    -0.0, -0.0, -0.99687696042532548, -0.0, -0.0, -0.0, -0.9969725461599982,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.794737846168156, -0.0, -0.0, -0.0, -0.97206782905967482,
    -0.0, -0.0, -0.0, -1.0116354965413776, -0.0, -0.0, -0.0, -1.02046423652327,
    -0.0, -0.0, -0.0, -1.0224341946893383, -0.0, -0.0, -0.0, -1.0228737517704187,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.69601056493544666, -0.0, -0.0,
    -0.0, -0.90564491852374507, -0.0, -0.0, -0.0, -0.96878557244249652, -0.0,
    -0.0, -0.0, -0.987803171939176, -0.0, -0.0, -0.0, -0.99353116283204024, -0.0,
    -0.0, -0.0, -0.99525640053485676, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.76399401734920225, -0.0, -0.0, -0.0, -0.95936956558454856, -0.0, -0.0,
    -0.0, -1.009332790402335, -0.0, -0.0, -0.0, -1.022109843911537, -0.0, -0.0,
    -0.0, -1.02537730907161, -0.0, -0.0, -0.0, -1.0262128951920408, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.77453923033201533, -0.0, -0.0, -0.0,
    -0.94736229283723949, -0.0, -0.0, -0.0, -0.98592433045137229, -0.0, -0.0,
    -0.0, -0.9945286840798635, -0.0, -0.0, -0.0, -0.99644857488296246, -0.0,
    -0.0, -0.0, -0.99687696042532548, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.794737846168156, -0.0, -0.0, -0.0, -0.97206782905967482, -0.0, -0.0, -0.0,
    -1.0116354965413776, -0.0, -0.0, -0.0, -1.02046423652327, -0.0, -0.0, -0.0,
    -1.0224341946893383, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.69601056493544666, -0.0, -0.0, -0.0, -0.90564491852374507,
    -0.0, -0.0, -0.0, -0.96878557244249652, -0.0, -0.0, -0.0, -0.987803171939176,
    -0.0, -0.0, -0.0, -0.99353116283204024, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.76399401734920225, -0.0, -0.0, -0.0,
    -0.95936956558454856, -0.0, -0.0, -0.0, -1.009332790402335, -0.0, -0.0, -0.0,
    -1.022109843911537, -0.0, -0.0, -0.0, -1.02537730907161, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.77453923033201533, -0.0,
    -0.0, -0.0, -0.94736229283723949, -0.0, -0.0, -0.0, -0.98592433045137229,
    -0.0, -0.0, -0.0, -0.9945286840798635, -0.0, -0.0, -0.0,
    -0.99644857488296246, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.794737846168156, -0.0, -0.0, -0.0, -0.97206782905967482, -0.0,
    -0.0, -0.0, -1.0116354965413776, -0.0, -0.0, -0.0, -1.02046423652327, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.69601056493544666, -0.0, -0.0, -0.0, -0.90564491852374507, -0.0,
    -0.0, -0.0, -0.96878557244249652, -0.0, -0.0, -0.0, -0.987803171939176, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.76399401734920225, -0.0, -0.0, -0.0, -0.95936956558454856, -0.0,
    -0.0, -0.0, -1.009332790402335, -0.0, -0.0, -0.0, -1.022109843911537, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.77453923033201533, -0.0, -0.0, -0.0, -0.94736229283723949, -0.0,
    -0.0, -0.0, -0.98592433045137229, -0.0, -0.0, -0.0, -0.9945286840798635,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.794737846168156, -0.0, -0.0, -0.0, -0.97206782905967482, -0.0,
    -0.0, -0.0, -1.0116354965413776, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.69601056493544666, -0.0, -0.0, -0.0, -0.90564491852374507, -0.0, -0.0,
    -0.0, -0.96878557244249652, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.76399401734920225, -0.0, -0.0, -0.0, -0.95936956558454856, -0.0, -0.0,
    -0.0, -1.009332790402335, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    -0.77453923033201533, -0.0, -0.0, -0.0, -0.94736229283723949, -0.0, -0.0,
    -0.0, -0.98592433045137229 };

  static const real_T b_Ku1[128] = { 9.9189621343297549, 0.0, 0.0, 0.0, 0.0,
    9.1639943627729661, 0.0, 0.0, 0.0, 0.0, 9.8866569158555, 0.0, 0.0, 0.0, 0.0,
    9.4211795680606976, 9.06334705546893, 0.0, 0.0, 0.0, 0.0, 8.4016115762936963,
    0.0, 0.0, 0.0, 0.0, 9.0475423194337523, 0.0, 0.0, 0.0, 0.0,
    8.6085034846235722, 8.0594180725837266, 0.0, 0.0, 0.0, 0.0,
    7.4787781718505482, 0.0, 0.0, 0.0, 0.0, 8.0487209962683721, 0.0, 0.0, 0.0,
    0.0, 7.6549566222349164, 7.0224005311852977, 0.0, 0.0, 0.0, 0.0,
    6.5076606619437429, 0.0, 0.0, 0.0, 0.0, 7.0090714126142135, 0.0, 0.0, 0.0,
    0.0, 6.6699817488124769, 5.9780212074091441, 0.0, 0.0, 0.0, 0.0,
    5.5221420012587252, 0.0, 0.0, 0.0, 0.0, 5.9590332770975376, 0.0, 0.0, 0.0,
    0.0, 5.6780145436538882, 4.9320945868448414, 0.0, 0.0, 0.0, 0.0,
    4.5327563983724675, 0.0, 0.0, 0.0, 0.0, 4.9065434875639742, 0.0, 0.0, 0.0,
    0.0, 4.6845776927109117, 3.8862499969741124, 0.0, 0.0, 0.0, 0.0,
    3.5437685454140264, 0.0, 0.0, 0.0, 0.0, 3.8542283743063579, 0.0, 0.0, 0.0,
    0.0, 3.691218755755687, 2.8423386434761437, 0.0, 0.0, 0.0, 0.0,
    2.5600880108992352, 0.0, 0.0, 0.0, 0.0, 2.8050926367335967, 0.0, 0.0, 0.0,
    0.0, 2.6996960358127491 };

  static const real_T c_a[64] = { 0.22313016014842982, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.30119421191220208, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.25572915991310058, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.22313016014842982, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0 };

  static const real_T d_a[32] = { 0.12429917437625121, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.0, 0.0, 0.0, 0.13976115761755958, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.13099166785529429, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    0.12429917437625121, 0.0, 0.0, 0.0, 0.0 };

  static const real_T e_a[32] = { 0.013397356906095106, 0.0, 0.0, 0.0,
    0.023101937960645733, 0.0, 0.0, 0.0, 0.0, 0.019951504062256632, 0.0, 0.0,
    0.0, 0.024112346704921125, 0.0, 0.0, 0.0, 0.0, 0.016126310485710019, 0.0,
    0.0, 0.0, 0.02340771647661119, 0.0, 0.0, 0.0, 0.0, 0.01332093959789891, 0.0,
    0.0, 0.0, 0.023328050852245361 };

  real_T rtb_xest[8];
  real_T tmp[4];
  real_T d_a_0[8];
  real_T tmp_0;
  real_T tmp_1;
  real_T rtb_u_idx_0;
  real_T rtb_u_idx_1;
  real_T rtb_u_idx_2;
  real_T rtb_u_idx_3;
  if (mpc_genC_M->Timing.TaskCounters.TID[1] == 0) {
    /* MATLAB Function: '<S2>/optimizer' incorporates:
     *  Memory: '<S2>/last_x'
     *  UnitDelay: '<S2>/last_mv'
     */
    /* MATLAB Function 'MPC Controller/MPC/optimizer': '<S17>:1' */
    /* '<S17>:1:13' coder.extrinsic('mpcblock_optimizer_double_mex'); */
    /* '<S17>:1:14' coder.extrinsic('mpcblock_optimizer_single_mex'); */
    /* '<S17>:1:15' coder.extrinsic('mpcblock_refmd_double_mex'); */
    /* '<S17>:1:16' coder.extrinsic('mpcblock_refmd_single_mex'); */
    /*  Parameters */
    /* '<S17>:1:19' isSimulation = coder.target('Sfun') && ~coder.target('RtwForRapid') && ~coder.target('RtwForSim'); */
    /* '<S17>:1:20' isAdaptive = false; */
    /* '<S17>:1:21' isLTV = false; */
    /* '<S17>:1:22' isDouble = isa(ref,'double'); */
    /* '<S17>:1:23' ZERO = zeros('like',ref); */
    /* '<S17>:1:24' ONE = ones('like',ref); */
    /*  Pre-allocate all the MEX block outputs for the simulation mode */
    /* '<S17>:1:29' if isSimulation */
    /*  Get reference and MD signals -- accounting for previewing */
    /* '<S17>:1:43' if isSimulation */
    /* '<S17>:1:50' else */
    /*  When doing code generation, use M code directly */
    /* '<S17>:1:52' [rseq, vseq, v] = mpcblock_refmd(ref,md,nv,ny,p,yoff,voff,no_md,no_ref,openloopflag, Rscale, MDscale); */
    memset(&rseq[0], 0, 40U * sizeof(real_T));
    for (i = 0; i < 10; i++) {
      rseq[i * (int32_T)mpc_genC_ny] = 800.0;
      rseq[1 + i * (int32_T)mpc_genC_ny] = 2000.0;
      rseq[2 + i * (int32_T)mpc_genC_ny] = 1000.0;
      rseq[3 + i * (int32_T)mpc_genC_ny] = 3000.0;
    }

    /*  External MV override.   */
    /*  NOTE: old_u and ext_mv input signals are dimensionless but include offset */
    /* '<S17>:1:57' old_u = old_u - uoff; */
    rtb_u_idx_0 = mpc_genC_DW.last_mv_DSTATE[0];
    rtb_u_idx_1 = mpc_genC_DW.last_mv_DSTATE[1];
    rtb_u_idx_2 = mpc_genC_DW.last_mv_DSTATE[2];
    rtb_u_idx_3 = mpc_genC_DW.last_mv_DSTATE[3];

    /* '<S17>:1:58' if no_mv==ONE */
    /* '<S17>:1:59' delmv = zeros(nu,1,'like',ref); */
    /*  Obtain x[k|k] */
    /* '<S17>:1:67' xk = xk - xoff; */
    /*  Remove offset */
    /* '<S17>:1:68' if CustomEstimation==ONE */
    /* '<S17>:1:71' else */
    /*  Default state estimation.     */
    /*  Scale measured output and remove offset. */
    /* '<S17>:1:74' ym = ym.*Rscale(myindex) - myoff; */
    /*  Correct x(k|k-1) for possible external mv override. */
    /*  NOTE:  Offset was removed from x[k|k-1] at k=0. */
    /* '<S17>:1:77' xk = xk + Bu*delmv; */
    memcpy(&xk[0], &mpc_genC_DW.last_x_PreviousInput[0], sizeof(real_T) << 3U);

    /* SignalConversion: '<S17>/TmpSignal ConversionAt SFunction Inport3' incorporates:
     *  Inport: '<Root>/pbio_meas'
     *  Inport: '<Root>/pdie_meas'
     *  Inport: '<Root>/qbio_meas'
     *  Inport: '<Root>/qdie_meas'
     *  MATLAB Function: '<S2>/optimizer'
     */
    /*  Measurement upate to x(k|k) */
    /* '<S17>:1:79' ym_est = C(myindex,:)*xk + Dv(myindex,:)*v; */
    /* '<S17>:1:80' y_innov = ym - ym_est; */
    tmp[0] = mpc_genC_U.pbio_meas;
    tmp[1] = mpc_genC_U.qbio_meas;
    tmp[2] = mpc_genC_U.pdie_meas;
    tmp[3] = mpc_genC_U.qdie_meas;

    /* MATLAB Function: '<S2>/optimizer' */
    for (b_j = 0; b_j < 4; b_j++) {
      tmp_0 = 0.0;
      for (i = 0; i < 8; i++) {
        tmp_0 += b_a[(i << 2) + b_j] * xk[i];
      }

      y_innov[b_j] = tmp[b_j] - tmp_0;
    }

    /* '<S17>:1:81' xest = xk + M*y_innov; */
    for (b_j = 0; b_j < 8; b_j++) {
      rtb_xest[b_j] = (((a[b_j + 8] * y_innov[1] + a[b_j] * y_innov[0]) + a[b_j
                        + 16] * y_innov[2]) + a[b_j + 24] * y_innov[3]) + xk[b_j];
    }

    /*  Real-time MV target override */
    /*  Note: utargetValue is a vector length p*nu.   */
    /* '<S17>:1:86' if no_uref==ONE */
    /*  no external utarget */
    /* '<S17>:1:88' utargetValue = utarget; */
    /* '<S17>:1:96' if isSimulation */
    /* '<S17>:1:121' else */
    /*  When doing code generation, use M code directly */
    /* '<S17>:1:123' [u, cost, useq, status, iAout] = mpcblock_optimizer(... */
    /* '<S17>:1:124'             rseq, vseq, umin, umax, ymin, ymax, switch_in, xest, old_u, iA, ... */
    /* '<S17>:1:125'             isQP, nu, ny, degrees, Hinv, Kx, Ku1, Kut, Kr, Kv, Mlim, ... */
    /* '<S17>:1:126'             Mx, Mu1, Mv, z_degrees, utargetValue, p, uoff, voff, yoff, maxiter, CustomSolver, nxQP, openloopflag, ... */
    /* '<S17>:1:127'             lims_inport, no_umin, no_umax, no_ymin, no_ymax, switch_inport, ... */
    /* '<S17>:1:128'             no_switch, enable_value, return_cost, H, return_sequence, Linv, Ac, ... */
    /* '<S17>:1:129'             ywt, uwt, duwt, rhoeps, no_ywt, no_uwt, no_duwt, no_rhoeps,... */
    /* '<S17>:1:130'             Wy, Wdu, Jm, SuJm, Su1, Sx, Hv, Wu, I1, ... */
    /* '<S17>:1:131'             isAdaptive, isLTV, A, Bu, Bv, C, Dv, ... */
    /* '<S17>:1:132'             Mrows, nCC, Ecc, Fcc, Scc, Gcc); */
    for (i = 0; i < 32; i++) {
      tmp_0 = 0.0;
      for (b_j = 0; b_j < 8; b_j++) {
        tmp_0 += b_Kx[(i << 3) + b_j] * rtb_xest[b_j];
      }

      tmp_1 = 0.0;
      for (b_j = 0; b_j < 40; b_j++) {
        tmp_1 += b_Kr[40 * i + b_j] * rseq[b_j];
      }

      f[i] = (((b_Ku1[(i << 2) + 1] * rtb_u_idx_1 + b_Ku1[i << 2] * rtb_u_idx_0)
               + b_Ku1[(i << 2) + 2] * rtb_u_idx_2) + b_Ku1[(i << 2) + 3] *
              rtb_u_idx_3) + (tmp_0 + tmp_1);
      zopt[i] = 0.0;
    }

    for (i = 0; i < 32; i++) {
      for (b_j = 0; b_j < 32; b_j++) {
        zopt[i] -= b_Hinv[(b_j << 5) + i] * f[b_j];
      }
    }

    rtb_u_idx_0 += zopt[0];
    rtb_u_idx_1 += zopt[1];
    rtb_u_idx_2 += zopt[2];
    rtb_u_idx_3 += zopt[3];

    /* Outport: '<Root>/mpc_Pbio' */
    /* '<S17>:1:135' if CustomEstimation==ONE */
    /* '<S17>:1:137' else */
    /*  update x[k+1|k], assuming that above u and v will be applied. */
    /* '<S17>:1:139' xk1 = A*xk + Bu*(u - uoff) + Bv*v + L*y_innov; */
    /* '<S17>:1:141' xk1 = xk1 + xoff; */
    /*  Updated state must include offset */
    /* '<S17>:1:143' if CustomEstimation==ONE */
    /* '<S17>:1:146' else */
    /* '<S17>:1:147' xest = xest + xoff; */
    mpc_genC_Y.mpc_Pbio = rtb_u_idx_0;

    /* Outport: '<Root>/mpc_Qbio' */
    mpc_genC_Y.mpc_Qbio = rtb_u_idx_1;

    /* Outport: '<Root>/mpc_Pdie' */
    mpc_genC_Y.mpc_Pdie = rtb_u_idx_2;

    /* Outport: '<Root>/mpc_Qdie' */
    mpc_genC_Y.mpc_Qdie = rtb_u_idx_3;
    for (b_j = 0; b_j < 8; b_j++) {
      /* MATLAB Function: '<S2>/optimizer' */
      rtb_xest[b_j] = 0.0;
      for (i = 0; i < 8; i++) {
        rtb_xest[b_j] += c_a[(i << 3) + b_j] * xk[i];
      }

      d_a_0[b_j] = 0.0;
      d_a_0[b_j] += d_a[b_j] * rtb_u_idx_0;
      d_a_0[b_j] += d_a[b_j + 8] * rtb_u_idx_1;
      d_a_0[b_j] += d_a[b_j + 16] * rtb_u_idx_2;
      d_a_0[b_j] += d_a[b_j + 24] * rtb_u_idx_3;

      /* Update for Memory: '<S2>/last_x' incorporates:
       *  MATLAB Function: '<S2>/optimizer'
       */
      mpc_genC_DW.last_x_PreviousInput[b_j] = (((e_a[b_j + 8] * y_innov[1] +
        e_a[b_j] * y_innov[0]) + e_a[b_j + 16] * y_innov[2]) + e_a[b_j + 24] *
        y_innov[3]) + (rtb_xest[b_j] + d_a_0[b_j]);
    }

    /* Update for UnitDelay: '<S2>/last_mv' */
    mpc_genC_DW.last_mv_DSTATE[0] = rtb_u_idx_0;
    mpc_genC_DW.last_mv_DSTATE[1] = rtb_u_idx_1;
    mpc_genC_DW.last_mv_DSTATE[2] = rtb_u_idx_2;
    mpc_genC_DW.last_mv_DSTATE[3] = rtb_u_idx_3;
  }

  rate_scheduler();
}

/* Model initialize function */
void mpc_genC_initialize(void)
{
  /* Registration code */

  /* initialize real-time model */
  (void) memset((void *)mpc_genC_M, 0,
                sizeof(RT_MODEL_mpc_genC_T));

  /* states (dwork) */
  (void) memset((void *)&mpc_genC_DW, 0,
                sizeof(DW_mpc_genC_T));

  /* external inputs */
  (void)memset((void *)&mpc_genC_U, 0, sizeof(ExtU_mpc_genC_T));

  /* external outputs */
  (void) memset((void *)&mpc_genC_Y, 0,
                sizeof(ExtY_mpc_genC_T));
}

/* Model terminate function */
void mpc_genC_terminate(void)
{
  /* (no terminate code required) */
}

/*
 * File trailer for generated code.
 *
 * [EOF]
 */
